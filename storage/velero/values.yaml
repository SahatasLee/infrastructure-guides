# Velero Helm Chart Values
# Source: https://github.com/vmware-tanzu/helm-charts/blob/main/charts/velero/values.yaml

# Init containers to install plugins
initContainers:
  - name: velero-plugin-for-aws
    image: velero/velero-plugin-for-aws:v1.8.0
    volumeMounts:
      - mountPath: /target
        name: plugins

# Configuration settings
configuration:
  provider: aws
  
  # Backup Storage Location (Where to store backups)
  backupStorageLocation:
    name: default
    provider: aws
    bucket: velero-backups
    config:
      region: minio
      s3ForcePathStyle: true
      s3Url: http://minio.storage:9000 # Change to your MinIO/S3 URL
      publicUrl: http://minio.example.com:9000 # Optional: for download links

  # Volume Snapshot Location (For cloud provider snapshots)
  # volumeSnapshotLocation:
  #   name: default
  #   provider: aws
  #   config:
  #     region: us-east-1

# Credentials
credentials:
  useSecret: true
  secretContents: {} # Managed externally via 'kubectl create secret'
  existingSecret: cloud-credentials

# Resource Management
resources:
  requests:
    cpu: 500m
    memory: 512Mi
  limits:
    cpu: 1000m
    memory: 1024Mi

# Node Agent (formerly Restic) for PVC backups
deployNodeAgent: true

nodeAgent:
  podVolumePath: /var/lib/kubelet/pods
  privileged: true
  resources:
    requests:
      cpu: 500m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 1024Mi

# Schedules
schedules:
  daily-full-backup:
    disabled: false
    schedule: "0 1 * * *"
    template:
      ttl: "720h" # 30 days
      includedNamespaces:
        - "*"
      snapshotVolumes: true
